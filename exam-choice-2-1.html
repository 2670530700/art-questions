<!DOCTYPE html>
<html> 
  <head> 
    <meta charset="UTF-8"> 
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, shrink-to-fit=no"/>
    <meta name="renderer" content="webkit"/>
    <meta name="force-rendering" content="webkit"/>
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"/>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdui@1.0.1/dist/css/mdui.min.css" integrity="sha384-cLRrMq39HOZdvE0j6yBojO4+1PrHfB7a9l5qLcmRm/fiWXYY+CndJPmyu5FV/9Tw" crossorigin="anonymous"/>
    <link rel="stylesheet" href="app/app.css">
    <title>选择题-基础知识-第一部分</title>
    <style>
      .mdui-card-header-title {
        margin:0px;
      }
      .mdui-card-primary {
        margin-top: -30px;
      }
      .mdui-card-content {
        margin-top: -10px;
      }
    </style>
  </head> 
  <body class="mdui-bottom-nav-fixed mdui-theme-primary-indigo mdui-theme-accent-indigo"> 
    <header class="mdui-appbar mdui-appbar-fixed mdui-shadow-2">
      <div class="mdui-toolbar">
        <span id="title" class="mdui-typo-title">题库</span>
        <div class="mdui-toolbar-spacer"></div>
        <button id="back" onclick="CloseWebPage()" class="mdui-btn mdui-btn-icon" mdui-tooltip="{content: '返回'}">
          <i class="mdui-icon material-icons">arrow_back</i>
        </button>
      </div>
    </header>
    
    <div class="mdui-container">
    <div id="main" style="margin-top: 75px;">
    </div>
    </div>
    <script src="https://cdn.jsdelivr.net/npm/mdui@1.0.1/dist/js/mdui.min.js" integrity="sha384-gCMZcshYKOGRX9r6wbDrvF+TcCCswSHFucUzUPwka+Gr+uHgjlYvkABr95TCOz3A" crossorigin="anonymous"></script>
  </body>
  <script src="src/exam-choice-2-1.js"></script>
  <script src="vConsole_main.js"></script>
  <script src="app/functions.js"></script>
  <script>
    var parent = document.getElementById("main");
    function dialog() {
      mdui.snackbar({
        message: "该功能正在研发中，敬请期待"
      });
    }
    function getSum(total, num) {
      return total + num;
    }
    function lastquestion() {
      if (thisindex!=0) {
        divs[thisindex].style.display = "none";
        divs[thisindex-1].style.display = "";
        thisindex = thisindex - 1;
      }
    }
    function nextquestion() {
      divs[thisindex].style.display = "none";
      if (thisindex!=4) {
        divs[thisindex+1].style.display = "";
        thisindex = thisindex + 1;
      }
      else {
        var newdiv = document.createElement("div");
        var text = "";
        var scores = [];
        var i=0;
        for (;i<5;i+=1) {
          var score = 0;
          for (var a=1;a<5;a+=1) {
            console.log("choice"+i.toString()+"-"+a.toString())
            if (document.getElementById("choice"+i.toString()+"-"+a.toString()).checked) {
              if (a-1==exams[i].answer) {
                score = 2;
                break;
              }
            }
          }
          scores.push(score);
          var text = text + "<thead><tr><td>" + (i + 1).toString() + "</td><td>" + score.toString() + "</td><td>无</td></tr></thead>";
        }
        newdiv.classList.add("mdui-table-fluid");
        newdiv.innerHTML = '<table class="mdui-table">' +
          '<thead><tr><th>题号</th><th>得分</th><th>标记</th></tr></thead>' + text +
          '<thead><tr><td>总分</td><td>' + scores.reduce(getSum).toString() + '</td></tr></thead></table>';
        parent.appendChild(newdiv);
      }
    }
    for (index in exams) {
      var answer = exams[index].choice[exams[index].answer];
      exams[index].choice.sort(function(){return Math.random()>0.5?-1:1;});
      exams[index].answer = exams[index].choice.indexOf(answer);
      var newdiv = document.createElement("div");
      newdiv.classList.add("mdui-card");
      newdiv.style.display = "none";
      if (index!=20) {
        var next = "下一题";
      }
      else {
        var next = "交卷评分";
      }
      newdiv.innerHTML = '<div class="mdui-card-header">' +
        '<div class="mdui-card-header-title">第' + (parseInt(index) + 1).toString() + '题</div></div>' +
        '<div class="mdui-card-primary">' + exams[index].question + '</div>' +
        '<div class="mdui-card-content"><form>' + 
        '<div class="mdui-col">' +
        '<label class="mdui-radio"><input id="choice' + index.toString() + '-1" type="radio" name="choice"/>' +
        '<i class="mdui-radio-icon"></i>' + exams[index].choice[0] + '</label></div>' +
        '<div class="mdui-col">' +
        '<label class="mdui-radio"><input id="choice' + index.toString() + '-2" type="radio" name="choice"/>' +
        '<i class="mdui-radio-icon"></i>' + exams[index].choice[1] + '</label></div>' +
        '<div class="mdui-col">' +
        '<label class="mdui-radio"><input id="choice' + index.toString() + '-3" type="radio" name="choice"/>' +
        '<i class="mdui-radio-icon"></i>' + exams[index].choice[2] + '</label></div>' +
        '<div class="mdui-col">' +
        '<label class="mdui-radio"><input id="choice' + index.toString() + '-4" type="radio" name="choice"/>' +
        '<i class="mdui-radio-icon"></i>' + exams[index].choice[3] + '</label></div></form></div>' +
        '<div class="mdui-card-actions">' +
        '<button id="mark" onclick="dialog()" class="mdui-btn mdui-ripple mdui-float-left">添加标记</button>' +
        '<button id="last" onclick="lastquestion()" class="mdui-btn mdui-ripple">上一题</button>' +
        '<button id="next" onclick="nextquestion()" class="mdui-btn mdui-ripple">下一题</button></div></div>';
      parent.appendChild(newdiv);
    }
    var divs = document.getElementsByClassName("mdui-card");
    divs[0].style.display = "";
    thisindex = 0
  </script>
</html>